# PowerAnalysis: Warmup

AUTHOR: ANISH SINGHANI

Description
This encryption algorithm leaks a "bit" of data every time it does a computation. Use [this](https://github.com/LeonGurin/picoCTF-2023/blob/main/Cryptography/PowerAnalysis%20Warmup/encrypt.py) to figure out the encryption key.
Additional details will be available after launching your challenge instance.

*Note:* This challenge launches an instance on demand.

___

This was the most research I did for a challenge ever.

First, what is power analysis? 

In basic terms (I'm not an expert at all), it's a way to get information by measuring the voltage during an operation, for us it's cracking AES.

This challenge did not involve measuring time/voltage and we are just getting the amount of bits leaked during the encryption.

What do we do anyway?

If we could isolate one byte of the plaintext we enter and know if it leaked a bit, we could break the encryption.

I think, either my way was super bad or there had to have been a better way to bruteforce inputs.

My way:

1. I found a unique string that returned 16 leaked bits, this ensures the position of each comparison (if I leaked 8 bits, I don't actually know which bits were leaked). Method: bruteforce by hand (bad)

I got the string: `b'ddddddddd0ddddddd3d0ddd0dddddddd'` 

2. For every byte in the sent string, I replaced it with every value between 0x00 to 0xff (16*16 possibilities) that means I send strings like:

```
00ddddddd0ddddddd3d0ddd0dddddddd
01ddddddd0ddddddd3d0ddd0dddddddd
02ddddddd0ddddddd3d0ddd0dddddddd
...
ffddddddd0ddddddd3d0ddd0dddddddd
```

And get only the values that satisfied the equation:

```python
Sbox[byte_of_plaintext_at_i ^ byte_of_plaintext_at_i] & 0x01 == 0x01
```

How?

If the value of the leaked bits is still 16.

After getting a huge array of the possible bytes, we can iterate through every possible key_byte combination and find the *only* one that satisfies

```python
Sbox[byte_we_got ^ key_value_bruteforced] & 0x01 == 0x01
```

For every byte we got previously.

This gets us the hex value of every byte of the key at every position and thus the key.

I used two python scripts because I'm bad.

Getting the bytes array:

```python
from pwn import *

Sbox = (
    0x63, 0x7C, 0x77, 0x7B, 0xF2, 0x6B, 0x6F, 0xC5, 0x30, 0x01, 0x67, 0x2B, 0xFE, 0xD7, 0xAB, 0x76,
    0xCA, 0x82, 0xC9, 0x7D, 0xFA, 0x59, 0x47, 0xF0, 0xAD, 0xD4, 0xA2, 0xAF, 0x9C, 0xA4, 0x72, 0xC0,
    0xB7, 0xFD, 0x93, 0x26, 0x36, 0x3F, 0xF7, 0xCC, 0x34, 0xA5, 0xE5, 0xF1, 0x71, 0xD8, 0x31, 0x15,
    0x04, 0xC7, 0x23, 0xC3, 0x18, 0x96, 0x05, 0x9A, 0x07, 0x12, 0x80, 0xE2, 0xEB, 0x27, 0xB2, 0x75,
    0x09, 0x83, 0x2C, 0x1A, 0x1B, 0x6E, 0x5A, 0xA0, 0x52, 0x3B, 0xD6, 0xB3, 0x29, 0xE3, 0x2F, 0x84,
    0x53, 0xD1, 0x00, 0xED, 0x20, 0xFC, 0xB1, 0x5B, 0x6A, 0xCB, 0xBE, 0x39, 0x4A, 0x4C, 0x58, 0xCF,
    0xD0, 0xEF, 0xAA, 0xFB, 0x43, 0x4D, 0x33, 0x85, 0x45, 0xF9, 0x02, 0x7F, 0x50, 0x3C, 0x9F, 0xA8,
    0x51, 0xA3, 0x40, 0x8F, 0x92, 0x9D, 0x38, 0xF5, 0xBC, 0xB6, 0xDA, 0x21, 0x10, 0xFF, 0xF3, 0xD2,
    0xCD, 0x0C, 0x13, 0xEC, 0x5F, 0x97, 0x44, 0x17, 0xC4, 0xA7, 0x7E, 0x3D, 0x64, 0x5D, 0x19, 0x73,
    0x60, 0x81, 0x4F, 0xDC, 0x22, 0x2A, 0x90, 0x88, 0x46, 0xEE, 0xB8, 0x14, 0xDE, 0x5E, 0x0B, 0xDB,
    0xE0, 0x32, 0x3A, 0x0A, 0x49, 0x06, 0x24, 0x5C, 0xC2, 0xD3, 0xAC, 0x62, 0x91, 0x95, 0xE4, 0x79,
    0xE7, 0xC8, 0x37, 0x6D, 0x8D, 0xD5, 0x4E, 0xA9, 0x6C, 0x56, 0xF4, 0xEA, 0x65, 0x7A, 0xAE, 0x08,
    0xBA, 0x78, 0x25, 0x2E, 0x1C, 0xA6, 0xB4, 0xC6, 0xE8, 0xDD, 0x74, 0x1F, 0x4B, 0xBD, 0x8B, 0x8A,
    0x70, 0x3E, 0xB5, 0x66, 0x48, 0x03, 0xF6, 0x0E, 0x61, 0x35, 0x57, 0xB9, 0x86, 0xC1, 0x1D, 0x9E,
    0xE1, 0xF8, 0x98, 0x11, 0x69, 0xD9, 0x8E, 0x94, 0x9B, 0x1E, 0x87, 0xE9, 0xCE, 0x55, 0x28, 0xDF,
    0x8C, 0xA1, 0x89, 0x0D, 0xBF, 0xE6, 0x42, 0x68, 0x41, 0x99, 0x2D, 0x0F, 0xB0, 0x54, 0xBB, 0x16,
)

part1 = b'dd'
part2 = b'ddddd0ddddddd3d0ddd0dddddddd'
pt = b'ddddddddd0ddddddd3d0ddd0dddddddd'

barray = []
for j in range(15,16):
    part1 = pt[:2*(j)]
    part2 = pt[2*(j+1):]
    print(part1 + b" " + part2)
    for i in range(16*16):
        io = remote('saturn.picoctf.net', 52665)
        io.recvuntil('Please provide 16 bytes of plaintext encoded as hex: ')
        hexNum = i.to_bytes(1, byteorder='big', signed=False)
        hexNum = ''.join(format(x, '02x') for x in hexNum).encode()
        send = part1 + hexNum + part2
        io.sendline(send)
        ret = io.recvline().decode()
        if int(ret[-3:]) == 16:
            barray.append("0x" + hexNum.decode())
            print(barray)
        io.close()
    barray.append("ended")
```

This is supposed to get a huge array of byte values by position, the "ended" string splits between positions.

Instead of parsing and because of connection issues, I ran it like 6 times to get parts of the arrays and used regex in VS code to make the data usable in the next script.

Getting the bytes of the key:

```python
from pwn import *

from Crypto.Util.number import long_to_bytes

Sbox = (
    0x63, 0x7C, 0x77, 0x7B, 0xF2, 0x6B, 0x6F, 0xC5, 0x30, 0x01, 0x67, 0x2B, 0xFE, 0xD7, 0xAB, 0x76,
    0xCA, 0x82, 0xC9, 0x7D, 0xFA, 0x59, 0x47, 0xF0, 0xAD, 0xD4, 0xA2, 0xAF, 0x9C, 0xA4, 0x72, 0xC0,
    0xB7, 0xFD, 0x93, 0x26, 0x36, 0x3F, 0xF7, 0xCC, 0x34, 0xA5, 0xE5, 0xF1, 0x71, 0xD8, 0x31, 0x15,
    0x04, 0xC7, 0x23, 0xC3, 0x18, 0x96, 0x05, 0x9A, 0x07, 0x12, 0x80, 0xE2, 0xEB, 0x27, 0xB2, 0x75,
    0x09, 0x83, 0x2C, 0x1A, 0x1B, 0x6E, 0x5A, 0xA0, 0x52, 0x3B, 0xD6, 0xB3, 0x29, 0xE3, 0x2F, 0x84,
    0x53, 0xD1, 0x00, 0xED, 0x20, 0xFC, 0xB1, 0x5B, 0x6A, 0xCB, 0xBE, 0x39, 0x4A, 0x4C, 0x58, 0xCF,
    0xD0, 0xEF, 0xAA, 0xFB, 0x43, 0x4D, 0x33, 0x85, 0x45, 0xF9, 0x02, 0x7F, 0x50, 0x3C, 0x9F, 0xA8,
    0x51, 0xA3, 0x40, 0x8F, 0x92, 0x9D, 0x38, 0xF5, 0xBC, 0xB6, 0xDA, 0x21, 0x10, 0xFF, 0xF3, 0xD2,
    0xCD, 0x0C, 0x13, 0xEC, 0x5F, 0x97, 0x44, 0x17, 0xC4, 0xA7, 0x7E, 0x3D, 0x64, 0x5D, 0x19, 0x73,
    0x60, 0x81, 0x4F, 0xDC, 0x22, 0x2A, 0x90, 0x88, 0x46, 0xEE, 0xB8, 0x14, 0xDE, 0x5E, 0x0B, 0xDB,
    0xE0, 0x32, 0x3A, 0x0A, 0x49, 0x06, 0x24, 0x5C, 0xC2, 0xD3, 0xAC, 0x62, 0x91, 0x95, 0xE4, 0x79,
    0xE7, 0xC8, 0x37, 0x6D, 0x8D, 0xD5, 0x4E, 0xA9, 0x6C, 0x56, 0xF4, 0xEA, 0x65, 0x7A, 0xAE, 0x08,
    0xBA, 0x78, 0x25, 0x2E, 0x1C, 0xA6, 0xB4, 0xC6, 0xE8, 0xDD, 0x74, 0x1F, 0x4B, 0xBD, 0x8B, 0x8A,
    0x70, 0x3E, 0xB5, 0x66, 0x48, 0x03, 0xF6, 0x0E, 0x61, 0x35, 0x57, 0xB9, 0x86, 0xC1, 0x1D, 0x9E,
    0xE1, 0xF8, 0x98, 0x11, 0x69, 0xD9, 0x8E, 0x94, 0x9B, 0x1E, 0x87, 0xE9, 0xCE, 0x55, 0x28, 0xDF,
    0x8C, 0xA1, 0x89, 0x0D, 0xBF, 0xE6, 0x42, 0x68, 0x41, 0x99, 0x2D, 0x0F, 0xB0, 0x54, 0xBB, 0x16,
)


a1 = [0x02, 0x03, 0x0c, 0x0f, 0x10, 0x12, 0x13, 0x14, 0x16, 0x18, 0x19, 0x1a, 0x1d, 0x1f, 0x21, 0x28, 0x29, 0x2a, 0x2d, 0x2e, 0x2f, 0x30, 0x31, 0x32, 0x34, 0x39, 0x40, 0x43, 0x44, 0x45, 0x46, 0x47, 0x48, 0x4f, 0x50, 0x51, 0x53, 0x54, 0x56, 0x5f, 0x63, 0x64, 0x65, 0x66, 0x67, 0x69, 0x6c, 0x6e, 0x6f, 0x70, 0x72, 0x75, 0x76, 0x77, 0x78, 0x79, 0x7d, 0x7e, 0x85, 0x86, 0x88, 0x8b, 0x8e, 0x8f, 0x90, 0x93, 0x94, 0x96, 0x97, 0x98, 0x9a, 0x9b, 0x9d, 0x9e, 0x9f, 0xa0, 0xa1, 0xa2, 0xa5, 0xab, 0xac, 0xae, 0xaf, 0xb1, 0xb2, 0xb3, 0xb4, 0xb6, 0xb7, 0xb8, 0xbb, 0xbc, 0xbd, 0xbf, 0xc2, 0xc4, 0xc6, 0xca, 0xcb, 0xcc, 0xcd, 0xce, 0xd0, 0xd1, 0xd3, 0xd4, 0xd6, 0xd9, 0xdc, 0xdd, 0xe0, 0xe3, 0xe6, 0xe8, 0xea, 0xec, 0xed, 0xee, 0xf3, 0xf4, 0xf5, 0xf6, 0xf8, 0xf9, 0xfa, 0xfb, 0xfc, 0xfe]
a2 = [0x00, 0x01, 0x03, 0x05, 0x08, 0x10, 0x18, 0x19, 0x1b, 0x1c, 0x1e, 0x1f, 0x21, 0x22, 0x23, 0x25, 0x27, 0x28, 0x29, 0x2b, 0x2c, 0x2e, 0x32, 0x33, 0x3d, 0x3e, 0x41, 0x43, 0x44, 0x46, 0x47, 0x48, 0x49, 0x4c, 0x4f, 0x52, 0x54, 0x55, 0x56, 0x57, 0x58, 0x5d, 0x5e, 0x5f, 0x60, 0x61, 0x62, 0x65, 0x67, 0x6e, 0x71, 0x72, 0x74, 0x75, 0x76, 0x77, 0x79, 0x7e, 0x80, 0x82, 0x83, 0x85, 0x86, 0x87, 0x89, 0x8a, 0x8c, 0x8d, 0x8e, 0x90, 0x91, 0x93, 0x94, 0x9a, 0x9d, 0x9e, 0x9f, 0xa1, 0xa2, 0xa5, 0xa6, 0xa7, 0xa9, 0xaa, 0xab, 0xac, 0xae, 0xaf, 0xb4, 0xb7, 0xb9, 0xba, 0xbe, 0xbf, 0xc2, 0xc4, 0xc5, 0xc7, 0xc8, 0xc9, 0xca, 0xcb, 0xcd, 0xcf, 0xd1, 0xd2, 0xd7, 0xd9, 0xdb, 0xdc, 0xdd, 0xdf, 0xe0, 0xe1, 0xe2, 0xe5, 0xe7, 0xe8, 0xec, 0xed, 0xf3, 0xf5, 0xf7, 0xfa, 0xfb, 0xfc, 0xfd, 0xff]
a3 = [0x02, 0x03, 0x0c, 0x0f, 0x10, 0x12, 0x13, 0x14, 0x16, 0x18, 0x19, 0x1a, 0x1d, 0x1f, 0x21, 0x28, 0x29, 0x2a, 0x2d, 0x2e, 0x2f, 0x30, 0x31, 0x32, 0x34, 0x39, 0x40, 0x43, 0x44, 0x45, 0x46, 0x47, 0x48, 0x4f, 0x50, 0x51, 0x53, 0x54, 0x56, 0x5f, 0x63, 0x64, 0x65, 0x66, 0x67, 0x69, 0x6c, 0x6e, 0x6f, 0x70, 0x72, 0x75, 0x76, 0x77, 0x78, 0x79, 0x7d, 0x7e, 0x85, 0x86, 0x88, 0x8b, 0x8e, 0x8f, 0x90, 0x93, 0x94, 0x96, 0x97, 0x98, 0x9a, 0x9b, 0x9d, 0x9e, 0x9f, 0xa0, 0xa1, 0xa2, 0xa5, 0xab, 0xac, 0xae, 0xaf, 0xb1, 0xb2, 0xb3, 0xb4, 0xb6, 0xb7, 0xb8, 0xbb, 0xbc, 0xbd, 0xbf, 0xc2, 0xc4, 0xc6, 0xca, 0xcb, 0xcc, 0xcd, 0xce, 0xd0, 0xd1, 0xd3, 0xd4, 0xd6, 0xd9, 0xdc, 0xdd, 0xe0, 0xe3, 0xe6, 0xe8, 0xea, 0xec, 0xed, 0xee, 0xf3, 0xf4, 0xf5, 0xf6, 0xf8, 0xf9, 0xfa, 0xfb, 0xfc, 0xfe]
a4 = [0x00, 0x03, 0x0e, 0x0f, 0x11, 0x13, 0x14, 0x15, 0x16, 0x18, 0x1a, 0x1c, 0x1e, 0x1f, 0x21, 0x22, 0x23, 0x24, 0x25, 0x26, 0x2d, 0x35, 0x38, 0x3c, 0x3d, 0x3e, 0x43, 0x44, 0x48, 0x49, 0x4a, 0x4b, 0x4c, 0x4f, 0x53, 0x58, 0x5a, 0x5c, 0x5d, 0x5f, 0x60, 0x62, 0x63, 0x65, 0x68, 0x69, 0x6a, 0x6b, 0x6f, 0x71, 0x72, 0x74, 0x75, 0x79, 0x7a, 0x7b, 0x7c, 0x7e, 0x82, 0x83, 0x84, 0x87, 0x89, 0x8a, 0x91, 0x92, 0x93, 0x94, 0x96, 0x97, 0x98, 0x9a, 0x9b, 0x9c, 0x9f, 0xa0, 0xa2, 0xa3, 0xa7, 0xa9, 0xac, 0xad, 0xae, 0xb0, 0xb1, 0xb3, 0xb4, 0xb7, 0xb8, 0xba, 0xbb, 0xbd, 0xbe, 0xbf, 0xc0, 0xc1, 0xc2, 0xc6, 0xc7, 0xc8, 0xca, 0xce, 0xd0, 0xd1, 0xd5, 0xd8, 0xda, 0xdc, 0xdd, 0xdf, 0xe0, 0xe1, 0xe2, 0xe4, 0xe6, 0xea, 0xec, 0xef, 0xf0, 0xf2, 0xf4, 0xf5, 0xf6, 0xf7, 0xf8, 0xf9, 0xfa, 0xff]
a5 = [0x00, 0x01, 0x05, 0x08, 0x0a, 0x0c, 0x0d, 0x0f, 0x10, 0x11, 0x12, 0x16, 0x17, 0x18, 0x1a, 0x1e, 0x20, 0x22, 0x24, 0x25, 0x26, 0x27, 0x28, 0x29, 0x2a, 0x2f, 0x30, 0x31, 0x32, 0x34, 0x36, 0x3a, 0x3c, 0x3f, 0x41, 0x42, 0x43, 0x44, 0x46, 0x47, 0x48, 0x4a, 0x4b, 0x4c, 0x4f, 0x52, 0x53, 0x54, 0x57, 0x59, 0x5a, 0x60, 0x61, 0x63, 0x64, 0x67, 0x68, 0x6a, 0x6b, 0x6d, 0x6e, 0x6f, 0x70, 0x72, 0x73, 0x77, 0x79, 0x7c, 0x7d, 0x7e, 0x83, 0x88, 0x8a, 0x8c, 0x8d, 0x8f, 0x93, 0x94, 0x98, 0x99, 0x9a, 0x9b, 0x9c, 0x9f, 0xa1, 0xa2, 0xa4, 0xa5, 0xa9, 0xaa, 0xab, 0xac, 0xae, 0xb0, 0xb2, 0xb3, 0xb5, 0xb8, 0xb9, 0xba, 0xbb, 0xbf, 0xc1, 0xc3, 0xc4, 0xc5, 0xc6, 0xc8, 0xca, 0xcc, 0xce, 0xcf, 0xd0, 0xd3, 0xde, 0xdf, 0xe5, 0xe8, 0xec, 0xed, 0xee, 0xf1, 0xf2, 0xf3, 0xf4, 0xf5, 0xf6, 0xfd]
a6 = [0x02, 0x03, 0x04, 0x05, 0x07, 0x0b, 0x0d, 0x0f, 0x10, 0x14, 0x15, 0x18, 0x19, 0x1a, 0x1d, 0x1f, 0x21, 0x23, 0x24, 0x25, 0x27, 0x29, 0x2a, 0x2f, 0x30, 0x31, 0x32, 0x33, 0x35, 0x37, 0x3a, 0x3c, 0x3d, 0x3f, 0x41, 0x42, 0x46, 0x47, 0x4c, 0x4f, 0x51, 0x52, 0x53, 0x54, 0x56, 0x57, 0x59, 0x5a, 0x5d, 0x5e, 0x5f, 0x62, 0x65, 0x66, 0x67, 0x68, 0x69, 0x6b, 0x6c, 0x71, 0x72, 0x74, 0x75, 0x76, 0x78, 0x7a, 0x7b, 0x7d, 0x7e, 0x7f, 0x81, 0x86, 0x89, 0x8a, 0x8c, 0x8d, 0x8e, 0x8f, 0x96, 0x98, 0x99, 0x9a, 0x9d, 0x9f, 0xa0, 0xa5, 0xa6, 0xa7, 0xaa, 0xac, 0xad, 0xae, 0xaf, 0xb0, 0xb1, 0xb4, 0xb7, 0xb9, 0xbb, 0xbc, 0xbe, 0xbf, 0xc5, 0xc6, 0xca, 0xcb, 0xd0, 0xd1, 0xd3, 0xd4, 0xd6, 0xd9, 0xda, 0xdb, 0xdd, 0xdf, 0xe0, 0xe1, 0xe3, 0xe4, 0xe6, 0xe7, 0xe8, 0xf0, 0xf8, 0xf9, 0xfb, 0xfd]
a7 = [0x00, 0x01, 0x02, 0x03, 0x05, 0x06, 0x09, 0x0e, 0x10, 0x12, 0x15, 0x16, 0x17, 0x19, 0x20, 0x21, 0x22, 0x23, 0x25, 0x28, 0x29, 0x2a, 0x2f, 0x30, 0x31, 0x33, 0x34, 0x36, 0x38, 0x3b, 0x3e, 0x3f, 0x44, 0x45, 0x49, 0x4a, 0x50, 0x52, 0x54, 0x55, 0x56, 0x59, 0x5b, 0x5c, 0x5e, 0x5f, 0x67, 0x68, 0x69, 0x6b, 0x6c, 0x6e, 0x6f, 0x72, 0x74, 0x76, 0x77, 0x7f, 0x80, 0x82, 0x84, 0x88, 0x8a, 0x8b, 0x8c, 0x8d, 0x90, 0x92, 0x95, 0x96, 0x97, 0x9a, 0x9b, 0x9f, 0xa0, 0xa5, 0xa6, 0xa8, 0xaa, 0xab, 0xac, 0xae, 0xb0, 0xb2, 0xb3, 0xb5, 0xb8, 0xba, 0xbc, 0xbd, 0xbe, 0xbf, 0xc0, 0xc3, 0xc8, 0xc9, 0xcd, 0xce, 0xd0, 0xd1, 0xd2, 0xd5, 0xd6, 0xd8, 0xd9, 0xdb, 0xdc, 0xdd, 0xde, 0xe3, 0xe4, 0xe6, 0xe7, 0xe8, 0xe9, 0xea, 0xed, 0xf0, 0xf1, 0xf2, 0xf4, 0xf5, 0xf7, 0xf9, 0xfa, 0xfb, 0xfd, 0xfe]
a8 = [0x00, 0x02, 0x03, 0x05, 0x06, 0x07, 0x08, 0x0b, 0x0c, 0x0e, 0x0f, 0x10, 0x13, 0x16, 0x17, 0x1d, 0x1e, 0x20, 0x23, 0x24, 0x25, 0x27, 0x29, 0x2a, 0x2b, 0x2c, 0x2e, 0x2f, 0x33, 0x34, 0x36, 0x37, 0x38, 0x39, 0x3a, 0x3d, 0x41, 0x44, 0x45, 0x48, 0x49, 0x4b, 0x4c, 0x4e, 0x52, 0x53, 0x54, 0x55, 0x56, 0x5a, 0x5c, 0x5e, 0x60, 0x61, 0x62, 0x63, 0x64, 0x66, 0x6b, 0x6c, 0x6d, 0x6e, 0x70, 0x72, 0x74, 0x75, 0x76, 0x78, 0x7b, 0x7e, 0x80, 0x81, 0x82, 0x85, 0x87, 0x88, 0x8a, 0x8b, 0x8c, 0x8e, 0x94, 0x97, 0x9a, 0x9b, 0xa1, 0xa8, 0xa9, 0xaa, 0xac, 0xb0, 0xb1, 0xb2, 0xb5, 0xb6, 0xb7, 0xb9, 0xc7, 0xc8, 0xc9, 0xcb, 0xcc, 0xce, 0xd0, 0xd7, 0xd8, 0xdb, 0xdc, 0xdd, 0xde, 0xdf, 0xe0, 0xe1, 0xe5, 0xe6, 0xe8, 0xea, 0xed, 0xee, 0xef, 0xf1, 0xf4, 0xf6, 0xf7, 0xfb, 0xfc, 0xfd, 0xfe, 0xff]
a9 = [0x01, 0x02, 0x03, 0x04, 0x06, 0x07, 0x08, 0x0b, 0x0c, 0x0d, 0x0f, 0x10, 0x11, 0x12, 0x15, 0x1b, 0x1c, 0x1e, 0x1f, 0x20, 0x23, 0x24, 0x26, 0x27, 0x28, 0x2a, 0x2b, 0x2d, 0x2e, 0x2f, 0x35, 0x36, 0x38, 0x3b, 0x3e, 0x3f, 0x43, 0x44, 0x45, 0x46, 0x48, 0x49, 0x4a, 0x4b, 0x4c, 0x4e, 0x50, 0x53, 0x56, 0x58, 0x5a, 0x5c, 0x5d, 0x5e, 0x60, 0x61, 0x63, 0x64, 0x66, 0x69, 0x6c, 0x6d, 0x72, 0x74, 0x76, 0x7a, 0x7b, 0x7c, 0x7d, 0x7e, 0x80, 0x81, 0x82, 0x84, 0x89, 0x91, 0x98, 0x99, 0x9a, 0x9d, 0x9e, 0x9f, 0xa0, 0xa2, 0xa3, 0xa4, 0xa6, 0xa8, 0xa9, 0xaa, 0xad, 0xaf, 0xb2, 0xb3, 0xbc, 0xbf, 0xc0, 0xc2, 0xc5, 0xc6, 0xc7, 0xc8, 0xc9, 0xcd, 0xce, 0xd3, 0xd4, 0xd5, 0xd6, 0xd7, 0xd9, 0xdc, 0xde, 0xdf, 0xe0, 0xe1, 0xe3, 0xe4, 0xe6, 0xef, 0xf0, 0xf3, 0xf4, 0xf5, 0xf6, 0xf7, 0xf8, 0xff] 
a10 = [0x01, 0x02, 0x07, 0x09, 0x0b, 0x0c, 0x0d, 0x0f, 0x12, 0x14, 0x15, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1d, 0x1f, 0x23, 0x25, 0x27, 0x2a, 0x2b, 0x2c, 0x2d, 0x2f, 0x30, 0x31, 0x32, 0x35, 0x37, 0x38, 0x3c, 0x3d, 0x40, 0x41, 0x43, 0x44, 0x4a, 0x4d, 0x4e, 0x4f, 0x50, 0x52, 0x53, 0x55, 0x56, 0x57, 0x59, 0x5a, 0x5c, 0x5d, 0x5e, 0x64, 0x67, 0x69, 0x6a, 0x6e, 0x6f, 0x71, 0x72, 0x75, 0x76, 0x77, 0x79, 0x7a, 0x7b, 0x7c, 0x7e, 0x7f, 0x82, 0x84, 0x85, 0x86, 0x87, 0x88, 0x8d, 0x8e, 0x8f, 0x91, 0x93, 0x94, 0x96, 0x97, 0x98, 0x99, 0x9c, 0x9f, 0xa1, 0xa2, 0xa4, 0xa5, 0xa6, 0xa7, 0xa9, 0xae, 0xb0, 0xb1, 0xb2, 0xb5, 0xb7, 0xbe, 0xc0, 0xc8, 0xc9, 0xcb, 0xcc, 0xce, 0xcf, 0xd0, 0xd1, 0xd3, 0xd5, 0xd8, 0xe2, 0xe3, 0xed, 0xee, 0xf1, 0xf2, 0xf3, 0xf5, 0xf7, 0xf8, 0xf9, 0xfb, 0xfc, 0xfe]
a11 = [0x01, 0x02, 0x04, 0x05, 0x09, 0x0a, 0x0b, 0x0c, 0x0e, 0x10, 0x12, 0x13, 0x15, 0x18, 0x19, 0x1a, 0x1b, 0x1f, 0x23, 0x28, 0x2a, 0x2c, 0x2d, 0x2f, 0x33, 0x34, 0x38, 0x39, 0x3a, 0x3b, 0x3c, 0x3f, 0x45, 0x48, 0x4c, 0x4d, 0x4e, 0x51, 0x52, 0x53, 0x54, 0x55, 0x56, 0x5d, 0x61, 0x63, 0x64, 0x65, 0x66, 0x68, 0x6a, 0x6c, 0x6e, 0x6f, 0x70, 0x73, 0x7e, 0x7f, 0x80, 0x82, 0x84, 0x85, 0x86, 0x87, 0x88, 0x89, 0x8a, 0x8f, 0x90, 0x91, 0x92, 0x94, 0x96, 0x9a, 0x9c, 0x9f, 0xa0, 0xa1, 0xa5, 0xa8, 0xaa, 0xac, 0xad, 0xaf, 0xb0, 0xb1, 0xb2, 0xb6, 0xb7, 0xb8, 0xba, 0xbe, 0xc0, 0xc1, 0xc3, 0xc4, 0xc7, 0xc8, 0xca, 0xcb, 0xcd, 0xce, 0xcf, 0xd0, 0xd2, 0xd3, 0xd7, 0xd9, 0xdc, 0xdd, 0xde, 0xe1, 0xe2, 0xe3, 0xe4, 0xe6, 0xe7, 0xe8, 0xea, 0xeb, 0xec, 0xef, 0xf2, 0xf3, 0xf4, 0xf7, 0xf9, 0xfa]
a12 = [0x05, 0x08, 0x0c, 0x0d, 0x0e, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x1d, 0x21, 0x23, 0x24, 0x25, 0x26, 0x28, 0x2a, 0x2c, 0x2e, 0x2f, 0x30, 0x33, 0x3e, 0x3f, 0x41, 0x42, 0x44, 0x45, 0x49, 0x4a, 0x4b, 0x4c, 0x4e, 0x50, 0x52, 0x53, 0x55, 0x58, 0x59, 0x5a, 0x5b, 0x5f, 0x63, 0x68, 0x6a, 0x6c, 0x6d, 0x6f, 0x73, 0x74, 0x78, 0x79, 0x7a, 0x7b, 0x7c, 0x7f, 0x80, 0x81, 0x83, 0x84, 0x87, 0x88, 0x8a, 0x8b, 0x8d, 0x8e, 0x8f, 0x90, 0x92, 0x93, 0x97, 0x99, 0x9c, 0x9d, 0x9e, 0xa1, 0xa2, 0xa3, 0xa4, 0xa6, 0xa7, 0xa8, 0xaa, 0xab, 0xac, 0xaf, 0xb2, 0xb3, 0xb4, 0xb7, 0xb9, 0xba, 0xc0, 0xc2, 0xc4, 0xc5, 0xc6, 0xc7, 0xc8, 0xc9, 0xca, 0xcf, 0xd0, 0xd1, 0xd2, 0xd4, 0xd6, 0xda, 0xdc, 0xdf, 0xe0, 0xe1, 0xe5, 0xe8, 0xea, 0xec, 0xed, 0xef, 0xf0, 0xf1, 0xf2, 0xf6, 0xf7, 0xf8, 0xfa, 0xfe]
a13 = [0x02, 0x03, 0x05, 0x06, 0x08, 0x0b, 0x10, 0x12, 0x13, 0x15, 0x16, 0x17, 0x19, 0x1a, 0x1b, 0x1d, 0x1e, 0x21, 0x22, 0x23, 0x26, 0x28, 0x2c, 0x2d, 0x2f, 0x30, 0x31, 0x32, 0x35, 0x36, 0x39, 0x3a, 0x3b, 0x3c, 0x3e, 0x3f, 0x40, 0x41, 0x43, 0x46, 0x47, 0x49, 0x4b, 0x4f, 0x50, 0x51, 0x54, 0x59, 0x5b, 0x5c, 0x5d, 0x5e, 0x60, 0x61, 0x63, 0x65, 0x67, 0x6b, 0x6d, 0x6e, 0x71, 0x73, 0x74, 0x75, 0x76, 0x77, 0x78, 0x79, 0x7b, 0x7e, 0x81, 0x82, 0x8e, 0x8f, 0x90, 0x92, 0x94, 0x95, 0x97, 0x99, 0x9b, 0x9d, 0x9e, 0x9f, 0xa0, 0xa2, 0xa3, 0xa4, 0xa5, 0xa7, 0xac, 0xb4, 0xb9, 0xbc, 0xbd, 0xbf, 0xc2, 0xc5, 0xc8, 0xc9, 0xca, 0xcb, 0xcd, 0xce, 0xd2, 0xd9, 0xdb, 0xdc, 0xdd, 0xde, 0xe1, 0xe2, 0xe3, 0xe4, 0xe8, 0xe9, 0xea, 0xeb, 0xee, 0xf0, 0xf3, 0xf4, 0xf5, 0xf8, 0xfa, 0xfb, 0xfd, 0xff]
a14 = [0x00, 0x01, 0x02, 0x03, 0x05, 0x08, 0x09, 0x0a, 0x0f, 0x10, 0x11, 0x13, 0x14, 0x16, 0x18, 0x1b, 0x1e, 0x1f, 0x20, 0x21, 0x22, 0x23, 0x25, 0x26, 0x29, 0x2e, 0x30, 0x32, 0x35, 0x36, 0x37, 0x39, 0x47, 0x48, 0x49, 0x4b, 0x4c, 0x4e, 0x4f, 0x52, 0x54, 0x56, 0x57, 0x5f, 0x64, 0x65, 0x69, 0x6a, 0x70, 0x72, 0x74, 0x75, 0x76, 0x79, 0x7b, 0x7c, 0x7e, 0x7f, 0x80, 0x85, 0x86, 0x88, 0x8a, 0x8b, 0x8c, 0x8e, 0x90, 0x92, 0x93, 0x95, 0x98, 0x9a, 0x9c, 0x9d, 0x9e, 0x9f, 0xa0, 0xa2, 0xa4, 0xa8, 0xaa, 0xab, 0xac, 0xad, 0xb0, 0xb2, 0xb5, 0xb6, 0xb7, 0xba, 0xbb, 0xbf, 0xc3, 0xc4, 0xc6, 0xc7, 0xc8, 0xc9, 0xca, 0xcd, 0xd0, 0xd1, 0xd2, 0xd4, 0xd5, 0xd7, 0xd9, 0xda, 0xdb, 0xdd, 0xde, 0xe0, 0xe3, 0xe8, 0xe9, 0xed, 0xee, 0xf0, 0xf1, 0xf2, 0xf5, 0xf6, 0xf8, 0xf9, 0xfb, 0xfc, 0xfd, 0xfe]
a15 = [0x00, 0x01, 0x03, 0x04, 0x06, 0x07, 0x0f, 0x17, 0x1a, 0x1c, 0x1e, 0x1f, 0x21, 0x22, 0x2c, 0x2d, 0x31, 0x33, 0x34, 0x36, 0x37, 0x38, 0x3a, 0x3c, 0x3d, 0x3e, 0x40, 0x41, 0x42, 0x47, 0x48, 0x49, 0x4a, 0x4b, 0x4d, 0x50, 0x53, 0x56, 0x57, 0x58, 0x59, 0x5b, 0x5c, 0x5e, 0x61, 0x66, 0x68, 0x69, 0x6a, 0x6b, 0x6d, 0x6e, 0x71, 0x78, 0x7a, 0x7d, 0x7e, 0x7f, 0x80, 0x81, 0x82, 0x85, 0x8b, 0x8c, 0x8e, 0x8f, 0x91, 0x92, 0x93, 0x95, 0x96, 0x98, 0x99, 0x9a, 0x9c, 0x9d, 0x9f, 0xa0, 0xa1, 0xa5, 0xa6, 0xa8, 0xab, 0xb0, 0xb1, 0xb3, 0xb4, 0xb5, 0xb6, 0xb8, 0xb9, 0xba, 0xbd, 0xbe, 0xc0, 0xc2, 0xc3, 0xc4, 0xc6, 0xc8, 0xcd, 0xce, 0xd0, 0xd2, 0xd4, 0xd5, 0xd6, 0xd7, 0xd8, 0xda, 0xdb, 0xdd, 0xe0, 0xe2, 0xe3, 0xe4, 0xe5, 0xe8, 0xea, 0xec, 0xf2, 0xf3, 0xf7, 0xf8, 0xfa, 0xfd, 0xfe, 0xff]
a16 = [0x03, 0x05, 0x06, 0x07, 0x0e, 0x16, 0x18, 0x19, 0x1a, 0x1d, 0x1e, 0x1f, 0x21, 0x23, 0x24, 0x25, 0x27, 0x28, 0x2a, 0x2d, 0x2e, 0x2f, 0x34, 0x35, 0x38, 0x3b, 0x40, 0x41, 0x42, 0x45, 0x47, 0x49, 0x4a, 0x4e, 0x4f, 0x50, 0x51, 0x52, 0x53, 0x54, 0x58, 0x59, 0x5b, 0x5e, 0x61, 0x63, 0x64, 0x66, 0x67, 0x68, 0x70, 0x71, 0x72, 0x73, 0x74, 0x77, 0x78, 0x7f, 0x80, 0x81, 0x83, 0x84, 0x85, 0x86, 0x88, 0x8a, 0x8b, 0x8c, 0x8f, 0x92, 0x95, 0x96, 0x97, 0x98, 0x99, 0x9b, 0x9c, 0xa0, 0xa1, 0xa3, 0xa4, 0xa7, 0xa8, 0xa9, 0xaa, 0xac, 0xad, 0xaf, 0xb1, 0xb2, 0xb8, 0xb9, 0xbc, 0xbf, 0xc1, 0xc2, 0xc3, 0xc4, 0xc9, 0xcb, 0xcc, 0xcd, 0xce, 0xcf, 0xd1, 0xd4, 0xd7, 0xd9, 0xda, 0xdb, 0xdd, 0xdf, 0xe1, 0xe3, 0xe4, 0xe6, 0xe7, 0xea, 0xeb, 0xee, 0xf1, 0xf3, 0xf5, 0xf9, 0xfa, 0xfb, 0xfc, 0xfd]

key_guess = []

for i in range(16*16):
    check = True
    j = 0
    while check:
        if j < len(a16):
            ans = xor(i, a16[j])[-2:]
            ans = ''.join(format(x, '02x') for x in ans).encode()
            if Sbox[int(ans, 16)] & 0x01 != 1:
                check = False
            j += 1
        else:
            key_guess.append(i)
            print("key_guess = ", key_guess)
            check = False

hex_list = [hex(num) for num in key_guess]
hex_str = "".join(hex_list)
print(hex_str[2:])

# 9dac9d914154db052d7ce1a110fbb3aa
```

This script checks all which bytes we collected with a bruteforced key value to check if the computation:

```python
Sbox[int(ans, 16)] & 0x01 == 0x01
```

is true.

The *only* value that should satisfy the byte values is the part of the key.

To decode each byte I replaced the a-number variable inside the loop each run.

After running the scripts I got the flag

> picoCTF{9dac9d914154db052d7ce1a110fbb3aa}

*Rant:* I don't know if my calculation was the worst way possible to crack this challenge because the total computation time ONLY connecting and bruteforcing across the network took like an hour+.

The computation in the other python file that was done offline took less than a second so I wonder if I could speedup the connection speed to not make this challenge agonizingly stressful and painful every time I found a bug.

If you see this writeup, let me know how you did it, I would LOVE to see real solutions for this challenge from you guys.

Thank you for reading this writeup.
